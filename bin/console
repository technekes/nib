#!/bin/bash
#
# Start a repl for the given container
#
#/* vim: set filetype=sh : */

IRBRC="
require \"rubygems\"
require \"irb/completion\"
require \"irb/ext/save-history\"

# irb configuration
IRB.conf[:PROMPT_MODE] = :SIMPLE
IRB.conf[:AUTO_INDENT] = true

# irb history
IRB.conf[:EVAL_HISTORY] = 10
IRB.conf[:SAVE_HISTORY] = 1000
IRB.conf[:HISTORY_FILE] = \"/usr/src/app/tmp/irb_history\"
"

SCRIPT="
  echo '${IRBRC}' > /root/.irbrc

  if [ -f script/console ]; then
    script/console
  else
    if hash pry 2>/dev/null ; then
      bundle config console pry
    fi

    bundle console
  fi
"

source "/usr/local/bin/_tty"
